2025-04-08 11:22:43,168 [trainer.py] => config: ./exps/knn.json
2025-04-08 11:22:43,169 [trainer.py] => prefix: cil
2025-04-08 11:22:43,169 [trainer.py] => dataset: hrrp9
2025-04-08 11:22:43,169 [trainer.py] => memory_size: 500
2025-04-08 11:22:43,169 [trainer.py] => memory_per_class: 20
2025-04-08 11:22:43,169 [trainer.py] => fixed_memory: False
2025-04-08 11:22:43,169 [trainer.py] => shuffle: True
2025-04-08 11:22:43,169 [trainer.py] => init_cls: 5
2025-04-08 11:22:43,169 [trainer.py] => increment: 2
2025-04-08 11:22:43,169 [trainer.py] => model_name: knn
2025-04-08 11:22:43,169 [trainer.py] => batch_size: 128
2025-04-08 11:22:43,169 [trainer.py] => num_workers: 8
2025-04-08 11:22:43,169 [trainer.py] => device: [device(type='cuda', index=3)]
2025-04-08 11:22:43,169 [trainer.py] => topk: 5
2025-04-08 11:22:43,169 [trainer.py] => init_train: False
2025-04-08 11:22:43,169 [trainer.py] => seed1: [1993]
2025-04-08 11:22:43,169 [trainer.py] => convnet_path: checkpoints/init_train/resnet18_42503.pth
2025-04-08 11:22:43,169 [trainer.py] => fc_path: checkpoints/init_train/fc_42503.pth
2025-04-08 11:22:43,169 [trainer.py] => seed2: [2001]
2025-04-08 11:22:43,169 [trainer.py] => seed: 110
2025-04-08 11:22:43,658 [data_manager.py] => [4, 2, 8, 7, 1, 6, 5, 3, 0]
2025-04-08 11:22:43,993 [trainer.py] => All params: 0
2025-04-08 11:22:43,993 [trainer.py] => Trainable params: 0
2025-04-08 11:22:43,993 [knn.py] => Learning on 0-5
2025-04-08 11:22:44,032 [knn.py] => Processing training data...
2025-04-08 11:22:44,525 [knn.py] => Training KNN...
2025-04-08 11:22:44,533 [knn.py] => KNN training completed in 0.01 seconds
2025-04-08 11:22:45,213 [knn.py] => Test accuracy: 73.77%
2025-04-08 11:22:45,229 [knn.py] => Building rehearsal memory for KNN... (100 samples per class)
2025-04-08 11:22:45,229 [knn.py] => Reducing exemplars... (100 per class)
2025-04-08 11:22:45,229 [knn.py] => Constructing exemplars... (100 per class)
2025-04-08 11:22:46,196 [trainer.py] => task:0 training time:2.20s
2025-04-08 11:22:46,196 [trainer.py] => All params: 5130000
2025-04-08 11:22:46,777 [trainer.py] => No NME accuracy.
2025-04-08 11:22:46,778 [trainer.py] => CNN: {'total': 74.73, '00-04': 74.73, 'old': 0, 'new': 74.73}
2025-04-08 11:22:46,778 [trainer.py] => CNN top1 curve: [74.73]
2025-04-08 11:22:46,778 [trainer.py] => CNN top5 curve: [100.0]

2025-04-08 11:22:46,778 [trainer.py] => Average Accuracy (CNN): 74.73
2025-04-08 11:22:46,778 [trainer.py] => All params: 5130000
2025-04-08 11:22:46,778 [trainer.py] => Trainable params: 5130000
2025-04-08 11:22:46,778 [knn.py] => Learning on 5-7
2025-04-08 11:22:46,797 [knn.py] => Processing training data...
2025-04-08 11:22:47,120 [knn.py] => Training KNN...
2025-04-08 11:22:47,124 [knn.py] => KNN training completed in 0.00 seconds
2025-04-08 11:22:47,677 [knn.py] => Test accuracy: 36.67%
2025-04-08 11:22:47,686 [knn.py] => Building rehearsal memory for KNN... (71 samples per class)
2025-04-08 11:22:47,686 [knn.py] => Reducing exemplars... (71 per class)
2025-04-08 11:22:47,800 [knn.py] => Constructing exemplars... (71 per class)
2025-04-08 11:22:48,005 [trainer.py] => task:1 training time:1.23s
2025-04-08 11:22:48,008 [trainer.py] => All params: 2308500
2025-04-08 11:22:48,558 [trainer.py] => No NME accuracy.
2025-04-08 11:22:48,558 [trainer.py] => CNN: {'total': 35.43, '00-04': 16.1, '05-06': 83.75, 'old': 16.1, 'new': 83.75}
2025-04-08 11:22:48,558 [trainer.py] => CNN top1 curve: [74.73, 35.43]
2025-04-08 11:22:48,558 [trainer.py] => CNN top5 curve: [100.0, 83.12]

2025-04-08 11:22:48,558 [trainer.py] => Average Accuracy (CNN): 55.08
2025-04-08 11:22:48,558 [trainer.py] => All params: 2308500
2025-04-08 11:22:48,558 [trainer.py] => Trainable params: 2308500
2025-04-08 11:22:48,558 [knn.py] => Learning on 7-9
2025-04-08 11:22:48,578 [knn.py] => Processing training data...
2025-04-08 11:22:48,894 [knn.py] => Training KNN...
2025-04-08 11:22:48,897 [knn.py] => KNN training completed in 0.00 seconds
2025-04-08 11:22:49,391 [knn.py] => Test accuracy: 25.31%
2025-04-08 11:22:49,399 [knn.py] => Building rehearsal memory for KNN... (55 samples per class)
2025-04-08 11:22:49,399 [knn.py] => Reducing exemplars... (55 per class)
2025-04-08 11:22:49,549 [knn.py] => Constructing exemplars... (55 per class)
2025-04-08 11:22:49,741 [trainer.py] => task:2 training time:1.18s
2025-04-08 11:22:49,741 [trainer.py] => All params: 2306961
2025-04-08 11:22:50,339 [trainer.py] => No NME accuracy.
2025-04-08 11:22:50,340 [trainer.py] => CNN: {'total': 24.61, '00-04': 10.4, '05-06': 3.58, '07-08': 81.17, 'old': 8.45, 'new': 81.17}
2025-04-08 11:22:50,340 [trainer.py] => CNN top1 curve: [74.73, 35.43, 24.61]
2025-04-08 11:22:50,340 [trainer.py] => CNN top5 curve: [100.0, 83.12, 72.78]

2025-04-08 11:22:50,340 [trainer.py] => Average Accuracy (CNN): 44.923333333333325
2025-04-08 11:22:50,340 [trainer.py] => Time consumed in all training process:6.35s
2025-04-08 11:22:50,341 [trainer.py] => Average Time consumed in single task:1.54s
2025-04-08 11:22:50,342 [trainer.py] => Forgetting (CNN): 72.25
