2025-04-08 11:23:50,912 [trainer.py] => config: ./exps/knn.json
2025-04-08 11:23:50,912 [trainer.py] => prefix: cil
2025-04-08 11:23:50,912 [trainer.py] => dataset: hrrp9
2025-04-08 11:23:50,912 [trainer.py] => memory_size: 500
2025-04-08 11:23:50,912 [trainer.py] => memory_per_class: 20
2025-04-08 11:23:50,912 [trainer.py] => fixed_memory: False
2025-04-08 11:23:50,912 [trainer.py] => shuffle: True
2025-04-08 11:23:50,913 [trainer.py] => init_cls: 5
2025-04-08 11:23:50,913 [trainer.py] => increment: 2
2025-04-08 11:23:50,913 [trainer.py] => model_name: knn
2025-04-08 11:23:50,913 [trainer.py] => batch_size: 128
2025-04-08 11:23:50,913 [trainer.py] => num_workers: 8
2025-04-08 11:23:50,913 [trainer.py] => device: [device(type='cuda', index=2)]
2025-04-08 11:23:50,913 [trainer.py] => topk: 5
2025-04-08 11:23:50,913 [trainer.py] => init_train: False
2025-04-08 11:23:50,913 [trainer.py] => seed2: [1993]
2025-04-08 11:23:50,913 [trainer.py] => convnet_path: checkpoints/init_train/resnet18_42503.pth
2025-04-08 11:23:50,913 [trainer.py] => fc_path: checkpoints/init_train/fc_42503.pth
2025-04-08 11:23:50,913 [trainer.py] => seed: 2001
2025-04-08 11:23:50,913 [trainer.py] => seed1: [110]
2025-04-08 11:23:51,411 [data_manager.py] => [3, 5, 1, 7, 2, 8, 6, 4, 0]
2025-04-08 11:23:51,726 [trainer.py] => All params: 0
2025-04-08 11:23:51,726 [trainer.py] => Trainable params: 0
2025-04-08 11:23:51,726 [knn.py] => Learning on 0-5
2025-04-08 11:23:51,766 [knn.py] => Processing training data...
2025-04-08 11:23:52,234 [knn.py] => Training KNN...
2025-04-08 11:23:52,241 [knn.py] => KNN training completed in 0.01 seconds
2025-04-08 11:23:52,908 [knn.py] => Test accuracy: 73.00%
2025-04-08 11:23:52,924 [knn.py] => Building rehearsal memory for KNN... (100 samples per class)
2025-04-08 11:23:52,924 [knn.py] => Reducing exemplars... (100 per class)
2025-04-08 11:23:52,924 [knn.py] => Constructing exemplars... (100 per class)
2025-04-08 11:23:53,952 [trainer.py] => task:0 training time:2.23s
2025-04-08 11:23:53,953 [trainer.py] => All params: 5130000
2025-04-08 11:23:54,546 [trainer.py] => No NME accuracy.
2025-04-08 11:23:54,547 [trainer.py] => CNN: {'total': 73.2, '00-04': 73.2, 'old': 0, 'new': 73.2}
2025-04-08 11:23:54,547 [trainer.py] => CNN top1 curve: [73.2]
2025-04-08 11:23:54,547 [trainer.py] => CNN top5 curve: [100.0]

2025-04-08 11:23:54,547 [trainer.py] => Average Accuracy (CNN): 73.2
2025-04-08 11:23:54,547 [trainer.py] => All params: 5130000
2025-04-08 11:23:54,547 [trainer.py] => Trainable params: 5130000
2025-04-08 11:23:54,547 [knn.py] => Learning on 5-7
2025-04-08 11:23:54,564 [knn.py] => Processing training data...
2025-04-08 11:23:54,888 [knn.py] => Training KNN...
2025-04-08 11:23:54,892 [knn.py] => KNN training completed in 0.00 seconds
2025-04-08 11:23:55,434 [knn.py] => Test accuracy: 30.31%
2025-04-08 11:23:55,442 [knn.py] => Building rehearsal memory for KNN... (71 samples per class)
2025-04-08 11:23:55,442 [knn.py] => Reducing exemplars... (71 per class)
2025-04-08 11:23:55,537 [knn.py] => Constructing exemplars... (71 per class)
2025-04-08 11:23:55,758 [trainer.py] => task:1 training time:1.21s
2025-04-08 11:23:55,759 [trainer.py] => All params: 2308500
2025-04-08 11:23:56,315 [trainer.py] => No NME accuracy.
2025-04-08 11:23:56,315 [trainer.py] => CNN: {'total': 29.31, '00-04': 10.8, '05-06': 75.58, 'old': 10.8, 'new': 75.58}
2025-04-08 11:23:56,315 [trainer.py] => CNN top1 curve: [73.2, 29.31]
2025-04-08 11:23:56,316 [trainer.py] => CNN top5 curve: [100.0, 80.57]

2025-04-08 11:23:56,316 [trainer.py] => Average Accuracy (CNN): 51.255
2025-04-08 11:23:56,316 [trainer.py] => All params: 2308500
2025-04-08 11:23:56,316 [trainer.py] => Trainable params: 2308500
2025-04-08 11:23:56,316 [knn.py] => Learning on 7-9
2025-04-08 11:23:56,335 [knn.py] => Processing training data...
2025-04-08 11:23:56,661 [knn.py] => Training KNN...
2025-04-08 11:23:56,666 [knn.py] => KNN training completed in 0.00 seconds
2025-04-08 11:23:57,210 [knn.py] => Test accuracy: 24.24%
2025-04-08 11:23:57,218 [knn.py] => Building rehearsal memory for KNN... (55 samples per class)
2025-04-08 11:23:57,218 [knn.py] => Reducing exemplars... (55 per class)
2025-04-08 11:23:57,359 [knn.py] => Constructing exemplars... (55 per class)
2025-04-08 11:23:57,591 [trainer.py] => task:2 training time:1.27s
2025-04-08 11:23:57,591 [trainer.py] => All params: 2306961
2025-04-08 11:23:58,126 [trainer.py] => No NME accuracy.
2025-04-08 11:23:58,127 [trainer.py] => CNN: {'total': 22.94, '00-04': 9.83, '05-06': 3.42, '07-08': 75.25, 'old': 8.0, 'new': 75.25}
2025-04-08 11:23:58,127 [trainer.py] => CNN top1 curve: [73.2, 29.31, 22.94]
2025-04-08 11:23:58,127 [trainer.py] => CNN top5 curve: [100.0, 80.57, 75.19]

2025-04-08 11:23:58,127 [trainer.py] => Average Accuracy (CNN): 41.81666666666667
2025-04-08 11:23:58,127 [trainer.py] => Time consumed in all training process:6.40s
2025-04-08 11:23:58,127 [trainer.py] => Average Time consumed in single task:1.57s
2025-04-08 11:23:58,128 [trainer.py] => Forgetting (CNN): 67.765
