2025-04-08 11:22:54,340 [trainer.py] => config: ./exps/knn.json
2025-04-08 11:22:54,340 [trainer.py] => prefix: cil
2025-04-08 11:22:54,340 [trainer.py] => dataset: hrrp9
2025-04-08 11:22:54,340 [trainer.py] => memory_size: 500
2025-04-08 11:22:54,340 [trainer.py] => memory_per_class: 20
2025-04-08 11:22:54,340 [trainer.py] => fixed_memory: False
2025-04-08 11:22:54,340 [trainer.py] => shuffle: True
2025-04-08 11:22:54,340 [trainer.py] => init_cls: 5
2025-04-08 11:22:54,340 [trainer.py] => increment: 2
2025-04-08 11:22:54,340 [trainer.py] => model_name: knn
2025-04-08 11:22:54,340 [trainer.py] => batch_size: 128
2025-04-08 11:22:54,340 [trainer.py] => num_workers: 8
2025-04-08 11:22:54,340 [trainer.py] => device: [device(type='cuda', index=3)]
2025-04-08 11:22:54,340 [trainer.py] => topk: 5
2025-04-08 11:22:54,340 [trainer.py] => init_train: False
2025-04-08 11:22:54,340 [trainer.py] => seed: 1993
2025-04-08 11:22:54,340 [trainer.py] => convnet_path: checkpoints/init_train/resnet18_42503.pth
2025-04-08 11:22:54,340 [trainer.py] => fc_path: checkpoints/init_train/fc_42503.pth
2025-04-08 11:22:54,340 [trainer.py] => seed2: [2001]
2025-04-08 11:22:54,340 [trainer.py] => seed1: [110]
2025-04-08 11:22:54,829 [data_manager.py] => [4, 2, 5, 0, 3, 6, 7, 8, 1]
2025-04-08 11:22:55,142 [trainer.py] => All params: 0
2025-04-08 11:22:55,142 [trainer.py] => Trainable params: 0
2025-04-08 11:22:55,142 [knn.py] => Learning on 0-5
2025-04-08 11:22:55,187 [knn.py] => Processing training data...
2025-04-08 11:22:55,608 [knn.py] => Training KNN...
2025-04-08 11:22:55,614 [knn.py] => KNN training completed in 0.01 seconds
2025-04-08 11:22:56,349 [knn.py] => Test accuracy: 69.67%
2025-04-08 11:22:56,364 [knn.py] => Building rehearsal memory for KNN... (100 samples per class)
2025-04-08 11:22:56,365 [knn.py] => Reducing exemplars... (100 per class)
2025-04-08 11:22:56,365 [knn.py] => Constructing exemplars... (100 per class)
2025-04-08 11:22:57,305 [trainer.py] => task:0 training time:2.16s
2025-04-08 11:22:57,305 [trainer.py] => All params: 5130000
2025-04-08 11:22:57,861 [trainer.py] => No NME accuracy.
2025-04-08 11:22:57,861 [trainer.py] => CNN: {'total': 69.97, '00-04': 69.97, 'old': 0, 'new': 69.97}
2025-04-08 11:22:57,861 [trainer.py] => CNN top1 curve: [69.97]
2025-04-08 11:22:57,861 [trainer.py] => CNN top5 curve: [100.0]

2025-04-08 11:22:57,862 [trainer.py] => Average Accuracy (CNN): 69.97
2025-04-08 11:22:57,862 [trainer.py] => All params: 5130000
2025-04-08 11:22:57,862 [trainer.py] => Trainable params: 5130000
2025-04-08 11:22:57,862 [knn.py] => Learning on 5-7
2025-04-08 11:22:57,877 [knn.py] => Processing training data...
2025-04-08 11:22:58,172 [knn.py] => Training KNN...
2025-04-08 11:22:58,176 [knn.py] => KNN training completed in 0.00 seconds
2025-04-08 11:22:58,674 [knn.py] => Test accuracy: 38.14%
2025-04-08 11:22:58,682 [knn.py] => Building rehearsal memory for KNN... (71 samples per class)
2025-04-08 11:22:58,682 [knn.py] => Reducing exemplars... (71 per class)
2025-04-08 11:22:58,801 [knn.py] => Constructing exemplars... (71 per class)
2025-04-08 11:22:59,017 [trainer.py] => task:1 training time:1.15s
2025-04-08 11:22:59,017 [trainer.py] => All params: 2308500
2025-04-08 11:22:59,549 [trainer.py] => No NME accuracy.
2025-04-08 11:22:59,549 [trainer.py] => CNN: {'total': 36.6, '00-04': 15.8, '05-06': 88.58, 'old': 15.8, 'new': 88.58}
2025-04-08 11:22:59,549 [trainer.py] => CNN top1 curve: [69.97, 36.6]
2025-04-08 11:22:59,549 [trainer.py] => CNN top5 curve: [100.0, 81.9]

2025-04-08 11:22:59,549 [trainer.py] => Average Accuracy (CNN): 53.285
2025-04-08 11:22:59,549 [trainer.py] => All params: 2308500
2025-04-08 11:22:59,549 [trainer.py] => Trainable params: 2308500
2025-04-08 11:22:59,549 [knn.py] => Learning on 7-9
2025-04-08 11:22:59,584 [knn.py] => Processing training data...
2025-04-08 11:22:59,910 [knn.py] => Training KNN...
2025-04-08 11:22:59,915 [knn.py] => KNN training completed in 0.00 seconds
2025-04-08 11:23:00,490 [knn.py] => Test accuracy: 26.54%
2025-04-08 11:23:00,499 [knn.py] => Building rehearsal memory for KNN... (55 samples per class)
2025-04-08 11:23:00,499 [knn.py] => Reducing exemplars... (55 per class)
2025-04-08 11:23:00,663 [knn.py] => Constructing exemplars... (55 per class)
2025-04-08 11:23:00,904 [trainer.py] => task:2 training time:1.35s
2025-04-08 11:23:00,905 [trainer.py] => All params: 2306961
2025-04-08 11:23:01,404 [trainer.py] => No NME accuracy.
2025-04-08 11:23:01,404 [trainer.py] => CNN: {'total': 25.59, '00-04': 12.9, '05-06': 7.92, '07-08': 75.0, 'old': 11.48, 'new': 75.0}
2025-04-08 11:23:01,405 [trainer.py] => CNN top1 curve: [69.97, 36.6, 25.59]
2025-04-08 11:23:01,405 [trainer.py] => CNN top5 curve: [100.0, 81.9, 70.24]

2025-04-08 11:23:01,405 [trainer.py] => Average Accuracy (CNN): 44.053333333333335
2025-04-08 11:23:01,405 [trainer.py] => Time consumed in all training process:6.26s
2025-04-08 11:23:01,405 [trainer.py] => Average Time consumed in single task:1.56s
2025-04-08 11:23:01,406 [trainer.py] => Forgetting (CNN): 68.865
