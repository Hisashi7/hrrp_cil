2025-04-09 17:05:49,885 [trainer.py] => config: ./exps/knn.json
2025-04-09 17:05:49,885 [trainer.py] => prefix: cil
2025-04-09 17:05:49,885 [trainer.py] => dataset: hrrp9
2025-04-09 17:05:49,886 [trainer.py] => memory_size: 500
2025-04-09 17:05:49,886 [trainer.py] => memory_per_class: 20
2025-04-09 17:05:49,886 [trainer.py] => fixed_memory: False
2025-04-09 17:05:49,886 [trainer.py] => shuffle: True
2025-04-09 17:05:49,886 [trainer.py] => init_cls: 5
2025-04-09 17:05:49,886 [trainer.py] => increment: 2
2025-04-09 17:05:49,886 [trainer.py] => model_name: knn
2025-04-09 17:05:49,886 [trainer.py] => batch_size: 128
2025-04-09 17:05:49,886 [trainer.py] => num_workers: 8
2025-04-09 17:05:49,886 [trainer.py] => device: [device(type='cuda', index=2)]
2025-04-09 17:05:49,886 [trainer.py] => topk: 5
2025-04-09 17:05:49,886 [trainer.py] => init_train: False
2025-04-09 17:05:49,886 [trainer.py] => seed: 1993
2025-04-09 17:05:49,886 [trainer.py] => convnet_path: checkpoints/init_train/resnet18_42503.pth
2025-04-09 17:05:49,886 [trainer.py] => fc_path: checkpoints/init_train/fc_42503.pth
2025-04-09 17:05:49,886 [trainer.py] => seed2: [2001]
2025-04-09 17:05:49,886 [trainer.py] => seed1: [110]
2025-04-09 17:05:50,446 [data_manager.py] => [4, 2, 5, 0, 3, 6, 7, 8, 1]
2025-04-09 17:05:50,816 [trainer.py] => All params: 0
2025-04-09 17:05:50,816 [trainer.py] => Trainable params: 0
2025-04-09 17:05:50,816 [knn.py] => Learning on 0-5
2025-04-09 17:05:50,938 [knn.py] => Processing training data...
2025-04-09 17:05:51,427 [knn.py] => Training KNN...
2025-04-09 17:05:51,433 [knn.py] => KNN training completed in 0.01 seconds
2025-04-09 17:05:52,303 [knn.py] => Test accuracy: 69.67%
2025-04-09 17:05:52,329 [knn.py] => Model saved to saved_pth/knn/model_0.pkl
2025-04-09 17:05:52,343 [knn.py] => Building rehearsal memory for KNN... (100 samples per class)
2025-04-09 17:05:52,343 [knn.py] => Reducing exemplars... (100 per class)
2025-04-09 17:05:52,344 [knn.py] => Constructing exemplars... (100 per class)
2025-04-09 17:05:54,137 [trainer.py] => task:0 training time:3.32s
2025-04-09 17:05:54,138 [trainer.py] => All params: 5130000
2025-04-09 17:05:55,085 [trainer.py] => No NME accuracy.
2025-04-09 17:05:55,085 [trainer.py] => CNN: {'total': 69.97, '00-04': 69.97, 'old': 0, 'new': 69.97}
2025-04-09 17:05:55,085 [trainer.py] => CNN top1 curve: [69.97]
2025-04-09 17:05:55,085 [trainer.py] => CNN top5 curve: [100.0]

2025-04-09 17:05:55,086 [trainer.py] => Average Accuracy (CNN): 69.97
2025-04-09 17:05:55,086 [trainer.py] => All params: 5130000
2025-04-09 17:05:55,086 [trainer.py] => Trainable params: 5130000
2025-04-09 17:05:55,086 [knn.py] => Learning on 5-7
2025-04-09 17:05:55,125 [knn.py] => Processing training data...
2025-04-09 17:05:55,515 [knn.py] => Training KNN...
2025-04-09 17:05:55,518 [knn.py] => KNN training completed in 0.00 seconds
2025-04-09 17:05:56,467 [knn.py] => Test accuracy: 38.14%
2025-04-09 17:05:56,478 [knn.py] => Model saved to saved_pth/knn/model_1.pkl
2025-04-09 17:05:56,485 [knn.py] => Building rehearsal memory for KNN... (71 samples per class)
2025-04-09 17:05:56,485 [knn.py] => Reducing exemplars... (71 per class)
2025-04-09 17:05:56,653 [knn.py] => Constructing exemplars... (71 per class)
2025-04-09 17:05:57,319 [trainer.py] => task:1 training time:2.23s
2025-04-09 17:05:57,319 [trainer.py] => All params: 2308500
2025-04-09 17:05:58,373 [trainer.py] => No NME accuracy.
2025-04-09 17:05:58,374 [trainer.py] => CNN: {'total': 36.6, '00-04': 15.8, '05-06': 88.58, 'old': 15.8, 'new': 88.58}
2025-04-09 17:05:58,374 [trainer.py] => CNN top1 curve: [69.97, 36.6]
2025-04-09 17:05:58,374 [trainer.py] => CNN top5 curve: [100.0, 81.9]

2025-04-09 17:05:58,374 [trainer.py] => Average Accuracy (CNN): 53.285
2025-04-09 17:05:58,374 [trainer.py] => All params: 2308500
2025-04-09 17:05:58,374 [trainer.py] => Trainable params: 2308500
2025-04-09 17:05:58,374 [knn.py] => Learning on 7-9
2025-04-09 17:05:58,404 [knn.py] => Processing training data...
2025-04-09 17:05:58,702 [knn.py] => Training KNN...
2025-04-09 17:05:58,705 [knn.py] => KNN training completed in 0.00 seconds
2025-04-09 17:05:59,276 [knn.py] => Test accuracy: 26.54%
2025-04-09 17:05:59,287 [knn.py] => Model saved to saved_pth/knn/model_2.pkl
2025-04-09 17:05:59,317 [knn.py] => Building rehearsal memory for KNN... (55 samples per class)
2025-04-09 17:05:59,317 [knn.py] => Reducing exemplars... (55 per class)
2025-04-09 17:05:59,761 [knn.py] => Constructing exemplars... (55 per class)
2025-04-09 17:06:00,306 [trainer.py] => task:2 training time:1.93s
2025-04-09 17:06:00,307 [trainer.py] => All params: 2306961
2025-04-09 17:06:01,128 [trainer.py] => No NME accuracy.
2025-04-09 17:06:01,128 [trainer.py] => CNN: {'total': 25.59, '00-04': 12.9, '05-06': 7.92, '07-08': 75.0, 'old': 11.48, 'new': 75.0}
2025-04-09 17:06:01,128 [trainer.py] => CNN top1 curve: [69.97, 36.6, 25.59]
2025-04-09 17:06:01,128 [trainer.py] => CNN top5 curve: [100.0, 81.9, 70.24]

2025-04-09 17:06:01,129 [trainer.py] => Average Accuracy (CNN): 44.053333333333335
2025-04-09 17:06:01,129 [trainer.py] => Time consumed in all training process:10.31s
2025-04-09 17:06:01,129 [trainer.py] => Average Time consumed in single task:2.50s
2025-04-09 17:06:01,130 [trainer.py] => Forgetting (CNN): 68.865
